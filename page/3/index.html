<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Jamie McCrindle Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Jamie McCrindle Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-GZL9B6CNB7","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Jamie McCrindle | Jamie McCrindle</title><meta data-react-helmet="true" property="og:title" content="Jamie McCrindle | Jamie McCrindle"><meta data-react-helmet="true" name="description" content="A programming blog"><meta data-react-helmet="true" property="og:description" content="A programming blog"><meta data-react-helmet="true" property="og:url" content="https://foldr.uk/page/3"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="blog_posts_list"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo.jpeg"><link data-react-helmet="true" rel="canonical" href="https://foldr.uk/page/3"><link data-react-helmet="true" rel="alternate" href="https://foldr.uk/page/3" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://foldr.uk/page/3" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e3f1fff0.css">
<link rel="preload" href="/assets/js/runtime~main.d5fcaed6.js" as="script">
<link rel="preload" href="/assets/js/main.4955cd6a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.jpeg" alt="Jamie McCrindle Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.jpeg" alt="Jamie McCrindle Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Jamie McCrindle</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jamiemccrindle" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://twitter.com/foldr" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.jpeg" alt="Jamie McCrindle Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.jpeg" alt="Jamie McCrindle Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Jamie McCrindle</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/">Blog</a></li><li class="menu__list-item"><a href="https://github.com/jamiemccrindle" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://twitter.com/foldr" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper blog-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/exploiting-visual-studio-code-devcontainers">Exploiting Visual Studio Code Devcontainers</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/azure-app-service-devcontainer">Running a devcontainer in an Azure App Service</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/azure-bicep-app-service-custom-container">Building an Azure App Service with a custom container using Bicep</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/github-actions-schedule-to-delete-resources-from-resource-group">Keep your Azure Costs low by removing dev resources from resource groups on a schedule.</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/rotating-azure-credentials-in-github-with-terraform">How to rotate your AZURE_CREDENTIALS in GitHub with Terraform</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/how-to-install-a-specific-version-of-terraform-github-actions-using-apt-get">Install a specific version of Terraform in a Github Action using apt</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/microsoft-graph-terraform-data-source">Microsoft Graph API Terraform Data Source</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/bootstrap-terraform-state-in-azure">Bootstrap terraform state in azure</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/terraform-rotate-secrets">Safely rotate secrets with terraform</a></li></ul></nav></aside><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="blogPostTitle_GeHD"><a href="/azure-bicep-app-service-custom-container">Building an Azure App Service with a custom container using Bicep</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2021-05-30T00:00:00.000Z">May 30, 2021</time> Â· 3 min read</div><div class="avatar margin-vert--md"><a href="https://github.com/jamiemccrindle" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/909696?s=60&amp;v=4" alt="Jamie McCrindle"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/jamiemccrindle" target="_blank" rel="noopener noreferrer">Jamie McCrindle</a></div><small class="avatar__subtitle">foldr</small></div></div></header><div class="markdown"><p>Azure App Service with custom containers is a convenient way to host docker containers in Azure. While there
are a number of tutorials on how to do this with <code>az cli</code> there aren&#x27;t too many that show how to do it with
ARM templates or Azure Bicep. Read on to see how to set up an Azure Container Registry, create scope maps and scope mapped tokens, build and push a custom image and finally use that custom image in your Azure App Service.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="first-a-word-on-scope-maps-and-tokens"></a>First, a word on scope maps and tokens<a class="hash-link" href="#first-a-word-on-scope-maps-and-tokens" title="Direct link to heading">#</a></h2><p>Azure Container Registry has a number of authentication mechanisms for pulling docker images. The only one that lets you limit access to specific docker images are <a href="https://docs.microsoft.com/en-us/azure/container-registry/container-registry-repository-scoped-permissions" target="_blank" rel="noopener noreferrer">scoped mapped tokens</a> which is why I&#x27;m going to use them in this example.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Scope Maps and Scope Map Tokens are currently in preview, so use with caution in production.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setting-up-your-acr"></a>Setting up your ACR<a class="hash-link" href="#setting-up-your-acr" title="Direct link to heading">#</a></h2><p>You&#x27;ll need a Container Registry to host your custom container. The following bicep sets up a Premium Azure Container Registry. The reason I&#x27;m using a Premium SKU is so that I can create scoped maps and scope mapped tokens.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bicep"><pre tabindex="0" class="prism-code language-bicep codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">param location string = resourceGroup().location</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resource acr &#x27;Microsoft.ContainerRegistry/registries@2019-12-01-preview&#x27; = {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: acrName</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  location: location</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sku: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name: &#x27;Premium&#x27; // to support scope mapped tokens</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  properties: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    adminUserEnabled: false</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You may also want to assign an owner to your ACR</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bicep"><pre tabindex="0" class="prism-code language-bicep codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">param ownerPrincipalId string</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resource ownerRoleAssignment &#x27;Microsoft.Authorization/roleAssignments@2018-01-01-preview&#x27; = {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: guid(&#x27;${acr.id}/${ownerPrincipalId}/owner&#x27;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  scope: acr</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  properties: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    roleDefinitionId: &#x27;/subscriptions/${subscription().subscriptionId}/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    principalId: ownerPrincipalId</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And set up your scope maps and scope mapped tokens</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bicep"><pre tabindex="0" class="prism-code language-bicep codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// create a scope map for your repository</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resource bicepAppServiceContainerScopeMap &#x27;Microsoft.ContainerRegistry/registries/scopeMaps@2020-11-01-preview&#x27; = {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  parent: acr</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: &#x27;bicepAppServiceContainer&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  properties: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    actions: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;repositories/bicep-app-service-container/content/read&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;repositories/bicep-app-service-container/metadata/read&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// create a token and associate it with your scope map</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resource bicepAppServiceContainerToken &#x27;Microsoft.ContainerRegistry/registries/tokens@2020-11-01-preview&#x27; = {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  parent: acr</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: &#x27;bicepAppServiceContainer&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  properties: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    scopeMapId: bicepAppServiceContainerScopeMap.id</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    status: &#x27;enabled&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="generating-passwords-for-your-tokens"></a>Generating passwords for your tokens<a class="hash-link" href="#generating-passwords-for-your-tokens" title="Direct link to heading">#</a></h2><p>The bicep above will create the scope map tokens but will not generate the passwords. You&#x27;ll need <code>az cli</code> for that.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ACR_PULL_TOKEN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">az acr token credential generate -n bicepAppServiceContainer -r $ACR_NAME --expiration-in-days </span><span class="token variable number" style="color:rgb(247, 140, 108)">30</span><span class="token variable" style="color:rgb(191, 199, 213)"> --query passwords</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token variable number" style="color:rgb(247, 140, 108)">0</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token variable" style="color:rgb(191, 199, 213)">.value -o tsv</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will generate the passwords and set ACR_PULL_TOKEN to be the value of one of the generated passwords.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setting-up-your-app-service-with-a-custom-container"></a>Setting up your App Service with a Custom Container<a class="hash-link" href="#setting-up-your-app-service-with-a-custom-container" title="Direct link to heading">#</a></h2><p>Use the bicep below to create a linux App Service plan and an App Service that uses your custom container.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bicep"><pre tabindex="0" class="prism-code language-bicep codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@description(&#x27;The name of the app service that you wish to create.&#x27;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">param siteName string</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@description(&#x27;The docker registry hostname.&#x27;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">param dockerRegistryHost string</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@description(&#x27;The docker registry username.&#x27;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">param dockerUsername string;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@secure()</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@description(&#x27;The docker registry password.&#x27;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">param dockerPassword string</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@description(&#x27;The relative docker image name.&#x27;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">param dockerImage string</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var servicePlanName = &#x27;plan-${siteName}-001&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resource servicePlan &#x27;Microsoft.Web/serverfarms@2016-09-01&#x27; = {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  kind: &#x27;linux&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: servicePlanName</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  location: resourceGroup().location</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  properties: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name: servicePlanName</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reserved: true</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sku: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tier: &#x27;Standard&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name: &#x27;S1&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  dependsOn: []</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resource siteName_resource &#x27;Microsoft.Web/sites@2016-08-01&#x27; = {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: siteName</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  location: resourceGroup().location</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  properties: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    siteConfig: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      appSettings: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          name: &#x27;WEBSITES_ENABLE_APP_SERVICE_STORAGE&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          value: &#x27;false&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          name: &#x27;DOCKER_REGISTRY_SERVER_URL&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          value: &#x27;https://${dockerRegistryHost}&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          name: &#x27;DOCKER_REGISTRY_SERVER_USERNAME&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          value: dockerUsername</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          name: &#x27;DOCKER_REGISTRY_SERVER_PASSWORD&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          value: dockerPassword</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      linuxFxVersion: &#x27;DOCKER|${dockerRegistryHost}/${dockerImage}&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    serverFarmId: servicePlan.id</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To see a working example, have a look at the following repository <a href="https://github.com/jamiemccrindle/bicep-app-service-container" target="_blank" rel="noopener noreferrer">https://github.com/jamiemccrindle/bicep-app-service-container</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><a class="margin-horiz--sm" href="/tags/azure">azure</a><a class="margin-horiz--sm" href="/tags/bicep">bicep</a><a class="margin-horiz--sm" href="/tags/app-service">app-service</a><a class="margin-horiz--sm" href="/tags/docker">docker</a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/page/2"><div class="pagination-nav__label">Â« Newer Entries</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/page/4"><div class="pagination-nav__label">Older Entries Â»</div></a></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Socials</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/foldr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://github.com/jamiemccrindle" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://jamie.mccrindle.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>jamie.mccrindle.org<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Jamie McCrindle. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d5fcaed6.js"></script>
<script src="/assets/js/main.4955cd6a.js"></script>
</body>
</html>